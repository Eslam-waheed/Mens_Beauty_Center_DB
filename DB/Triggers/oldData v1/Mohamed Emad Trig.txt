--2. Triggers:
CREATE TABLE ServiceHistory
(
    ServiceID INT,
    OldPrice INT,
    ChangeDate DATE
);

CREATE TABLE PackageHistory
(
    PackageID INT,
    OldTotalAmount DECIMAL(18, 2),
    ChangeDate DATE
)


--------------------------------------
CREATE TRIGGER trg_UpdateServicePrice
ON Service
AFTER UPDATE
AS
BEGIN
    INSERT INTO ServiceHistory (ServiceID, OldPrice, ChangeDate)
    SELECT i.ID, d.Price, GETDATE()
    FROM Inserted i
    JOIN Deleted d ON i.ID = d.ID
END

CREATE TRIGGER trg_UpdatePackageTotalAmount
ON Package
AFTER UPDATE
AS
BEGIN
    INSERT INTO PackageHistory (PackageID, OldTotalAmount, ChangeDate)
    SELECT i.ID, d.TotalAmount, GETDATE()
    FROM Inserted i
    JOIN Deleted d ON i.ID = d.ID
END





